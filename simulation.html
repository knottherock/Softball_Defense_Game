<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Softball Simulation</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    .section { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
    select, button { width: 100%; margin-top: 10px; padding: 8px; }
  </style>
</head>
<body>

  <div class="section">
    <h2>üßæ Game Situation</h2>
    <p id="gameStateText"></p>
    <button onclick="quitGame()">Quit to Position Select</button>
  </div>

  <div class="section">
    <h2>üéÆ Defensive Decision Input</h2>

    <h3>If ball is hit to YOU:</h3>
    <label>Primary Action:</label>
    <select id="primarySelf">
      <option value="">-- Choose --</option>
      <option value="Throw to 1B">Throw to 1B</option>
      <option value="Throw to 2B">Throw to 2B</option>
      <option value="Throw to 3B">Throw to 3B</option>
      <option value="Throw to Home">Throw to Home</option>
      <option value="Throw to Pitcher">Throw to Pitcher</option>
    </select>

    <label>Secondary Action:</label>
    <select id="secondarySelf">
      <option value="">-- Choose --</option>
      <option value="Cover 2B">Cover 2B</option>
      <option value="Cover 3B">Cover 3B</option>
      <option value="Cover Home">Cover Home</option>
      <option value="Backup 1B">Backup 1B</option>
      <option value="Backup 2B">Backup 2B</option>
      <option value="Backup 3B">Backup 3B</option>
      <option value="Relay to Home">Relay to Home</option>
      <option value="Relay to 3B">Relay to 3B</option>
    </select>

    <h3>If ball is hit to ANOTHER:</h3>
    <label>Primary Action:</label>
    <select id="primaryOther">
      <option value="">-- Choose --</option>
      <option value="Backup 1B">Backup 1B</option>
      <option value="Backup 2B">Backup 2B</option>
      <option value="Backup 3B">Backup 3B</option>
      <option value="Backup Home">Backup Home</option>
      <option value="Cover 2B">Cover 2B</option>
      <option value="Cover 3B">Cover 3B</option>
      <option value="Cover Home">Cover Home</option>
      <option value="Cutoff to Home">Cutoff to Home</option>
      <option value="Cutoff to 3B">Cutoff to 3B</option>
    </select>

    <label>Secondary Action:</label>
    <select id="secondaryOther">
      <option value="">-- Choose --</option>
      <option value="Continue coverage">Continue coverage</option>
      <option value="Relay throw">Relay throw</option>
      <option value="Move to next base">Move to next base</option>
    </select>

    <button onclick="revealHit()">Lock In Decisions & Reveal Hit</button>
  </div>

  <div class="section" id="hitSection" style="display:none;">
    <h2>‚öæ Hit Simulation</h2>
    <p id="hitResult"></p>
    <button onclick="submitPlay()">Submit Play</button>
  </div>

  <div class="section" id="summarySection" style="display:none;">
    <h2>üß† Feedback</h2>
    <p id="summaryOutput"></p>
    <p id="feedbackOutput"></p>
    <button onclick="nextInning()">Next Inning</button>
  </div>

  <script>
    const positions = ["P", "C", "1B", "2B", "SS", "3B", "LF", "CF", "RF"];
    const hitTypes = ["Grounder", "Line Drive", "Pop Fly"];
    let hitTo = "", hitType = "";
    let gameState = { inning: 1, outs: 0, runners: [], score: { home: 0, away: 0 } };
    const playerPos = localStorage.getItem("playerPosition");

    function updateGameState() {
      const { inning, outs, runners, score } = gameState;
      document.getElementById("gameStateText").innerText =
        `Inning: ${inning}, Outs: ${outs}, Runners on: ${runners.join(", ") || "None"}, Score: Home ${score.home} - Away ${score.away}`;
    }

    function revealHit() {
      hitTo = positions[Math.floor(Math.random() * positions.length)];
      hitType = hitTypes[Math.floor(Math.random() * hitTypes.length)];
      document.getElementById("hitResult").innerText = `Ball hit to ${hitTo} (${hitType})`;
      document.getElementById("hitSection").style.display = "block";
      document.getElementById("summarySection").style.display = "none";
    }

    function submitPlay() {
      const ps = document.getElementById("primarySelf").value;
      const ss = document.getElementById("secondarySelf").value;
      const po = document.getElementById("primaryOther").value;
      const so = document.getElementById("secondaryOther").value;

      const summary = `
        <strong>Position:</strong> ${playerPos}<br>
        <strong>Hit:</strong> ${hitTo} (${hitType})<br><br>
        <strong>‚û° If ball is hit to YOU:</strong><br>
        Primary: ${ps}<br>
        Secondary: ${ss}<br><br>
        <strong>‚û° If ball is hit to ANOTHER:</strong><br>
        Primary: ${po}<br>
        Secondary: ${so}
      `;
      document.getElementById("summaryOutput").innerHTML = summary;
      document.getElementById("feedbackOutput").innerText = generateFeedback(playerPos, hitTo, hitType, ps, ss, po, so);
      document.getElementById("summarySection").style.display = "block";
    }

    function generateFeedback(pos, hitTo, hitType, ps, ss, po, so) {
      if (pos === hitTo) {
        if (ps.includes("Throw") && ss.includes("Cover")) {
          return "‚úÖ Smart play: You fielded and ensured coverage.";
        } else if (ps.includes("Throw") && ss.includes("Backup")) {
          return "‚úÖ Good throw, but consider covering a base for better field awareness.";
        } else {
          return "‚ö†Ô∏è Consider refining your throw or coverage strategy.";
        }
      } else {
        if (po.includes("Backup") && so.includes("Continue")) {
          return "‚úÖ Great awareness: You backed up and stayed engaged in the play.";
        } else if (po.includes("Cutoff") && so.includes("Relay")) {
          return "‚úÖ Excellent relay positioning after cutoff.";
        } else {
          return "‚ö†Ô∏è You might want to anticipate movement and adjust your coverage.";
        }
      }
    }

    function nextInning() {
      gameState.inning += 1;
      gameState.outs = 0;
      gameState.runners = [];
      gameState.score = { home: 0, away: 0 };
      updateGameState();
      document.getElementById("summarySection").style.display = "none";
      document.getElementById("hitSection").style.display = "none";
      document.getElementById("hitResult").innerText = "";
    }

    function quitGame() {
      localStorage.removeItem("playerPosition");
      window.location.href = "index.html";
    }

    updateGameState();
  </script>

</body>
</html>
